{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/api.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nconst _c0 = (a0, a1, a2) => ({\n  \"bg-success\": a0,\n  \"bg-warning\": a1,\n  \"bg-primary\": a2\n});\nfunction LoansComponent_div_16_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 17)(1, \"div\", 18)(2, \"h5\");\n    i0.ɵɵtext(3, \"Nouvel Emprunt\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 12)(5, \"form\", 19);\n    i0.ɵɵlistener(\"ngSubmit\", function LoansComponent_div_16_Template_form_ngSubmit_5_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.createLoan());\n    });\n    i0.ɵɵelementStart(6, \"div\", 0)(7, \"div\", 20)(8, \"div\", 21)(9, \"label\", 22);\n    i0.ɵɵtext(10, \"ID Utilisateur\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"input\", 23);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function LoansComponent_div_16_Template_input_ngModelChange_11_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.newLoan.user_id, $event) || (ctx_r1.newLoan.user_id = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(12, \"div\", 20)(13, \"div\", 21)(14, \"label\", 22);\n    i0.ɵɵtext(15, \"ID Livre\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"input\", 24);\n    i0.ɵɵtwoWayListener(\"ngModelChange\", function LoansComponent_div_16_Template_input_ngModelChange_16_listener($event) {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      i0.ɵɵtwoWayBindingSet(ctx_r1.newLoan.book_id, $event) || (ctx_r1.newLoan.book_id = $event);\n      return i0.ɵɵresetView($event);\n    });\n    i0.ɵɵelementEnd()()()();\n    i0.ɵɵelementStart(17, \"div\", 25)(18, \"button\", 26);\n    i0.ɵɵtext(19, \"Cr\\u00E9er l'Emprunt\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(20, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function LoansComponent_div_16_Template_button_click_20_listener() {\n      i0.ɵɵrestoreView(_r1);\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.cancelLoan());\n    });\n    i0.ɵɵtext(21, \"Annuler\");\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(11);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.newLoan.user_id);\n    i0.ɵɵadvance(5);\n    i0.ɵɵtwoWayProperty(\"ngModel\", ctx_r1.newLoan.book_id);\n  }\n}\nfunction LoansComponent_tr_38_button_17_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r3 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function LoansComponent_tr_38_button_17_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r3);\n      const loan_r4 = i0.ɵɵnextContext().$implicit;\n      const ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.returnBook(loan_r4.id));\n    });\n    i0.ɵɵelement(1, \"i\", 31);\n    i0.ɵɵtext(2, \" Retourner \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction LoansComponent_tr_38_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\")(14, \"span\", 28);\n    i0.ɵɵtext(15);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(16, \"td\");\n    i0.ɵɵtemplate(17, LoansComponent_tr_38_button_17_Template, 3, 0, \"button\", 29);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const loan_r4 = ctx.$implicit;\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(loan_r4.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate((loan_r4.user == null ? null : loan_r4.user.name) || \"Utilisateur #\" + loan_r4.user_id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate((loan_r4.book == null ? null : loan_r4.book.title) || \"Livre #\" + loan_r4.book_id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(9, 8, loan_r4.loan_date));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(12, 10, loan_r4.due_date));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(12, _c0, loan_r4.status === \"returned\", loan_r4.status === \"overdue\", loan_r4.status === \"active\"));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.getStatusLabel(loan_r4.status), \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", loan_r4.status === \"active\");\n  }\n}\nfunction LoansComponent_div_39_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32);\n    i0.ɵɵelement(1, \"i\", 33);\n    i0.ɵɵelementStart(2, \"p\", 34);\n    i0.ɵɵtext(3, \"Aucun emprunt trouv\\u00E9\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let LoansComponent = /*#__PURE__*/(() => {\n  class LoansComponent {\n    constructor(apiService) {\n      this.apiService = apiService;\n      this.loans = [];\n      this.overdueLoans = [];\n      this.displayedLoans = [];\n      this.activeTab = 'all';\n      this.showLoanForm = false;\n      this.newLoan = {};\n    }\n    ngOnInit() {\n      this.loadLoans();\n      this.loadOverdueLoans();\n    }\n    loadLoans() {\n      this.apiService.getLoans().subscribe({\n        next: response => {\n          this.loans = response.data || response;\n          this.updateDisplayedLoans();\n        },\n        error: error => console.error('Erreur lors du chargement des emprunts:', error)\n      });\n    }\n    loadOverdueLoans() {\n      this.apiService.getOverdueLoans().subscribe({\n        next: data => {\n          this.overdueLoans = data;\n          this.updateDisplayedLoans();\n        },\n        error: error => console.error('Erreur lors du chargement des emprunts en retard:', error)\n      });\n    }\n    setActiveTab(tab) {\n      this.activeTab = tab;\n      this.updateDisplayedLoans();\n    }\n    updateDisplayedLoans() {\n      if (this.activeTab === 'overdue') {\n        this.displayedLoans = this.overdueLoans;\n      } else {\n        this.displayedLoans = this.loans;\n      }\n    }\n    createLoan() {\n      if (this.newLoan.user_id && this.newLoan.book_id) {\n        this.apiService.createLoan(this.newLoan).subscribe({\n          next: () => {\n            this.loadLoans();\n            this.cancelLoan();\n          },\n          error: error => console.error('Erreur lors de la création de l\\'emprunt:', error)\n        });\n      }\n    }\n    returnBook(loanId) {\n      this.apiService.returnBook(loanId).subscribe({\n        next: () => {\n          this.loadLoans();\n          this.loadOverdueLoans();\n        },\n        error: error => console.error('Erreur lors du retour du livre:', error)\n      });\n    }\n    cancelLoan() {\n      this.showLoanForm = false;\n      this.newLoan = {};\n    }\n    getStatusLabel(status) {\n      const labels = {\n        'active': 'Actif',\n        'returned': 'Retourné',\n        'overdue': 'En Retard'\n      };\n      return labels[status] || status;\n    }\n    static {\n      this.ɵfac = function LoansComponent_Factory(t) {\n        return new (t || LoansComponent)(i0.ɵɵdirectiveInject(i1.ApiService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: LoansComponent,\n        selectors: [[\"app-loans\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 40,\n        vars: 8,\n        consts: [[1, \"row\"], [1, \"col-12\"], [1, \"fas\", \"fa-handshake\"], [1, \"row\", \"mb-4\"], [1, \"col-md-8\"], [\"role\", \"group\", 1, \"btn-group\"], [\"type\", \"button\", 1, \"btn\", 3, \"click\"], [1, \"col-md-4\"], [1, \"btn\", \"btn-success\", \"w-100\", 3, \"click\"], [1, \"fas\", \"fa-plus\"], [\"class\", \"card mb-4\", 4, \"ngIf\"], [1, \"card\"], [1, \"card-body\"], [1, \"table-responsive\"], [1, \"table\", \"table-striped\"], [4, \"ngFor\", \"ngForOf\"], [\"class\", \"text-center py-5\", 4, \"ngIf\"], [1, \"card\", \"mb-4\"], [1, \"card-header\"], [3, \"ngSubmit\"], [1, \"col-md-6\"], [1, \"mb-3\"], [1, \"form-label\"], [\"type\", \"number\", \"name\", \"user_id\", \"required\", \"\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [\"type\", \"number\", \"name\", \"book_id\", \"required\", \"\", 1, \"form-control\", 3, \"ngModelChange\", \"ngModel\"], [1, \"d-flex\", \"gap-2\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\"], [\"type\", \"button\", 1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"badge\", 3, \"ngClass\"], [\"class\", \"btn btn-sm btn-outline-success\", 3, \"click\", 4, \"ngIf\"], [1, \"btn\", \"btn-sm\", \"btn-outline-success\", 3, \"click\"], [1, \"fas\", \"fa-check\"], [1, \"text-center\", \"py-5\"], [1, \"fas\", \"fa-handshake\", \"fa-3x\", \"text-muted\", \"mb-3\"], [1, \"text-muted\"]],\n        template: function LoansComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n            i0.ɵɵelement(3, \"i\", 2);\n            i0.ɵɵtext(4, \" Gestion des Emprunts\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(5, \"div\", 3)(6, \"div\", 4)(7, \"div\", 5)(8, \"button\", 6);\n            i0.ɵɵlistener(\"click\", function LoansComponent_Template_button_click_8_listener() {\n              return ctx.setActiveTab(\"all\");\n            });\n            i0.ɵɵtext(9, \" Tous les Emprunts \");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(10, \"button\", 6);\n            i0.ɵɵlistener(\"click\", function LoansComponent_Template_button_click_10_listener() {\n              return ctx.setActiveTab(\"overdue\");\n            });\n            i0.ɵɵtext(11);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(12, \"div\", 7)(13, \"button\", 8);\n            i0.ɵɵlistener(\"click\", function LoansComponent_Template_button_click_13_listener() {\n              return ctx.showLoanForm = true;\n            });\n            i0.ɵɵelement(14, \"i\", 9);\n            i0.ɵɵtext(15, \" Nouvel Emprunt \");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(16, LoansComponent_div_16_Template, 22, 2, \"div\", 10);\n            i0.ɵɵelementStart(17, \"div\", 11)(18, \"div\", 12)(19, \"div\", 13)(20, \"table\", 14)(21, \"thead\")(22, \"tr\")(23, \"th\");\n            i0.ɵɵtext(24, \"ID\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(25, \"th\");\n            i0.ɵɵtext(26, \"Utilisateur\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(27, \"th\");\n            i0.ɵɵtext(28, \"Livre\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(29, \"th\");\n            i0.ɵɵtext(30, \"Date d'Emprunt\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(31, \"th\");\n            i0.ɵɵtext(32, \"Date d'\\u00C9ch\\u00E9ance\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(33, \"th\");\n            i0.ɵɵtext(34, \"Statut\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(35, \"th\");\n            i0.ɵɵtext(36, \"Actions\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(37, \"tbody\");\n            i0.ɵɵtemplate(38, LoansComponent_tr_38_Template, 18, 16, \"tr\", 15);\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(39, LoansComponent_div_39_Template, 4, 0, \"div\", 16);\n            i0.ɵɵelementEnd()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(8);\n            i0.ɵɵclassMap(ctx.activeTab === \"all\" ? \"btn-primary\" : \"btn-outline-primary\");\n            i0.ɵɵadvance(2);\n            i0.ɵɵclassMap(ctx.activeTab === \"overdue\" ? \"btn-warning\" : \"btn-outline-warning\");\n            i0.ɵɵadvance();\n            i0.ɵɵtextInterpolate1(\" En Retard (\", ctx.overdueLoans.length, \") \");\n            i0.ɵɵadvance(5);\n            i0.ɵɵproperty(\"ngIf\", ctx.showLoanForm);\n            i0.ɵɵadvance(22);\n            i0.ɵɵproperty(\"ngForOf\", ctx.displayedLoans);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.displayedLoans.length === 0);\n          }\n        },\n        dependencies: [CommonModule, i2.NgClass, i2.NgForOf, i2.NgIf, i2.DatePipe, FormsModule, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NumberValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.RequiredValidator, i3.NgModel, i3.NgForm],\n        styles: [\".table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-top:none}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:0}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:first-child{border-top-left-radius:.375rem;border-bottom-left-radius:.375rem}.btn-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:last-child{border-top-right-radius:.375rem;border-bottom-right-radius:.375rem}\"]\n      });\n    }\n  }\n  return LoansComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}