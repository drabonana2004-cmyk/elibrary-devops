{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nlet AdminDashboardComponent = class AdminDashboardComponent {\n  constructor(apiService, authService, router) {\n    this.apiService = apiService;\n    this.authService = authService;\n    this.router = router;\n    this.activeTab = 'dashboard';\n    this.stats = null;\n    this.books = [];\n    this.filteredBooks = [];\n    this.categories = [];\n    this.borrows = [];\n    this.users = [];\n    this.overdueBorrows = [];\n    this.registrationRequests = [];\n    this.auditLogs = [];\n    this.iotDevices = [];\n    this.shelves = [];\n    this.showAddBookForm = false;\n    this.newBook = {};\n    this.currentUser = this.authService.getCurrentUser();\n    // Filtres\n    this.bookSearch = '';\n    this.bookCategoryFilter = '';\n    this.bookAvailabilityFilter = '';\n    this.userSearch = '';\n    this.userRoleFilter = '';\n    this.userStatusFilter = '';\n    this.borrowView = 'current';\n    this.selectedBooks = [];\n    // Paramètres\n    this.settings = {\n      default_borrow_days: 14,\n      penalty_per_day: 0.5,\n      mqtt_broker: 'localhost:1883',\n      rfid_topic: 'library/rfid'\n    };\n  }\n  ngOnInit() {\n    this.loadStats();\n    this.loadBooks();\n    this.loadCategories();\n    this.loadBorrows();\n    this.loadUsers();\n  }\n  setActiveTab(tab) {\n    this.activeTab = tab;\n  }\n  getTabTitle() {\n    const titles = {\n      'dashboard': 'Tableau de bord',\n      'users': 'Utilisateurs',\n      'borrows': 'Emprunts',\n      'books': 'Livres / Catalogue',\n      'inventory': 'Inventaire (IoT)',\n      'overdue': 'Retards & Pénalités',\n      'requests': 'Demandes / Inscriptions',\n      'reports': 'Statistiques & Rapports',\n      'settings': 'Configuration / Paramètres',\n      'logs': 'Logs / Audit'\n    };\n    return titles[this.activeTab] || this.activeTab;\n  }\n  loadStats() {\n    this.apiService.getStatistics().subscribe({\n      next: data => this.stats = data,\n      error: error => console.error('Erreur stats:', error)\n    });\n  }\n  loadBooks() {\n    this.apiService.getBooks().subscribe({\n      next: data => this.books = data,\n      error: error => console.error('Erreur livres:', error)\n    });\n  }\n  loadCategories() {\n    this.apiService.getCategories().subscribe({\n      next: data => this.categories = data,\n      error: error => console.error('Erreur catégories:', error)\n    });\n  }\n  loadBorrows() {\n    this.apiService.getAllBorrows().subscribe({\n      next: data => this.borrows = data,\n      error: error => console.error('Erreur emprunts:', error)\n    });\n  }\n  addBook() {\n    if (this.newBook.title && this.newBook.author && this.newBook.isbn) {\n      this.apiService.createBook(this.newBook).subscribe({\n        next: () => {\n          this.loadBooks();\n          this.cancelAddBook();\n        },\n        error: error => console.error('Erreur ajout livre:', error)\n      });\n    }\n  }\n  cancelAddBook() {\n    this.showAddBookForm = false;\n    this.newBook = {};\n  }\n  returnBook(borrowId) {\n    this.apiService.returnBook(borrowId).subscribe({\n      next: () => {\n        this.loadBorrows();\n        this.loadStats();\n      },\n      error: error => console.error('Erreur retour:', error)\n    });\n  }\n  getStatusLabel(status) {\n    const labels = {\n      'active': 'Actif',\n      'returned': 'Retourné',\n      'overdue': 'En Retard'\n    };\n    return labels[status] || status;\n  }\n  loadUsers() {\n    this.apiService.getUsers().subscribe({\n      next: data => this.users = data,\n      error: error => console.error('Erreur utilisateurs:', error)\n    });\n  }\n  sendReminder(userId) {\n    this.apiService.sendReminder(userId).subscribe({\n      next: () => {\n        alert('Rappel envoyé avec succès!');\n      },\n      error: error => console.error('Erreur rappel:', error)\n    });\n  }\n  // Méthodes pour les livres\n  searchBooks() {\n    this.filterBooks();\n  }\n  filterBooks() {\n    this.filteredBooks = this.books.filter(book => {\n      const matchesSearch = !this.bookSearch || book.title.toLowerCase().includes(this.bookSearch.toLowerCase()) || book.author.toLowerCase().includes(this.bookSearch.toLowerCase()) || book.isbn.includes(this.bookSearch);\n      const matchesCategory = !this.bookCategoryFilter || book.category_id == this.bookCategoryFilter;\n      const matchesAvailability = !this.bookAvailabilityFilter || this.bookAvailabilityFilter === '1' && book.stock > 0 || this.bookAvailabilityFilter === '0' && book.stock <= 0;\n      return matchesSearch && matchesCategory && matchesAvailability;\n    });\n  }\n  selectAllBooks(event) {\n    if (event.target.checked) {\n      this.selectedBooks = this.filteredBooks.map(book => book.id);\n    } else {\n      this.selectedBooks = [];\n    }\n  }\n  toggleBookSelection(bookId, event) {\n    if (event.target.checked) {\n      this.selectedBooks.push(bookId);\n    } else {\n      this.selectedBooks = this.selectedBooks.filter(id => id !== bookId);\n    }\n  }\n  viewBook(book) {\n    console.log('Voir livre:', book);\n  }\n  editBook(book) {\n    console.log('Éditer livre:', book);\n  }\n  assignTag(book) {\n    console.log('Assigner tag:', book);\n  }\n  deleteBook(book) {\n    if (confirm(`Supprimer \"${book.title}\" ? Cette action est irréversible.`)) {\n      console.log('Supprimer livre:', book);\n    }\n  }\n  exportBooks() {\n    console.log('Export livres');\n  }\n  // Méthodes IoT\n  startInventoryScan() {\n    console.log('Démarrage scan inventaire');\n  }\n  // Méthodes rapports\n  exportReport(type) {\n    console.log('Export rapport:', type);\n  }\n  // Méthodes logs\n  getLogTypeClass(type) {\n    const classes = {\n      'admin': 'bg-primary',\n      'device': 'bg-info',\n      'error': 'bg-danger',\n      'system': 'bg-secondary'\n    };\n    return classes[type] || 'bg-secondary';\n  }\n  logout() {\n    this.authService.logout();\n    this.router.navigate(['/login']);\n  }\n};\nAdminDashboardComponent = __decorate([Component({\n  selector: 'app-admin-dashboard',\n  standalone: true,\n  imports: [CommonModule, FormsModule],\n  template: `\n    <div class=\"admin-layout\">\n      <!-- Sidebar -->\n      <div class=\"sidebar\">\n        <div class=\"sidebar-header\">\n          <h4><i class=\"fas fa-crown\"></i> Admin</h4>\n          <p class=\"text-muted\">{{currentUser?.name}}</p>\n        </div>\n        <nav class=\"sidebar-nav\">\n          <a class=\"nav-item\" [class.active]=\"activeTab === 'dashboard'\" (click)=\"setActiveTab('dashboard')\">\n            <i class=\"fas fa-tachometer-alt\"></i> Tableau de bord\n          </a>\n          <a class=\"nav-item\" [class.active]=\"activeTab === 'users'\" (click)=\"setActiveTab('users')\">\n            <i class=\"fas fa-users\"></i> Utilisateurs\n          </a>\n          <a class=\"nav-item\" [class.active]=\"activeTab === 'borrows'\" (click)=\"setActiveTab('borrows')\">\n            <i class=\"fas fa-handshake\"></i> Emprunts\n          </a>\n          <a class=\"nav-item\" [class.active]=\"activeTab === 'books'\" (click)=\"setActiveTab('books')\">\n            <i class=\"fas fa-book\"></i> Livres / Catalogue\n          </a>\n          <a class=\"nav-item\" [class.active]=\"activeTab === 'inventory'\" (click)=\"setActiveTab('inventory')\">\n            <i class=\"fas fa-warehouse\"></i> Inventaire (IoT)\n          </a>\n          <a class=\"nav-item\" [class.active]=\"activeTab === 'overdue'\" (click)=\"setActiveTab('overdue')\">\n            <i class=\"fas fa-exclamation-triangle\"></i> Retards & Pénalités\n          </a>\n          <a class=\"nav-item\" [class.active]=\"activeTab === 'requests'\" (click)=\"setActiveTab('requests')\">\n            <i class=\"fas fa-clipboard-list\"></i> Demandes / Inscriptions\n          </a>\n          <a class=\"nav-item\" [class.active]=\"activeTab === 'reports'\" (click)=\"setActiveTab('reports')\">\n            <i class=\"fas fa-chart-bar\"></i> Statistiques & Rapports\n          </a>\n          <a class=\"nav-item\" [class.active]=\"activeTab === 'settings'\" (click)=\"setActiveTab('settings')\">\n            <i class=\"fas fa-cog\"></i> Configuration\n          </a>\n          <a class=\"nav-item\" [class.active]=\"activeTab === 'logs'\" (click)=\"setActiveTab('logs')\">\n            <i class=\"fas fa-file-alt\"></i> Logs / Audit\n          </a>\n        </nav>\n        <div class=\"sidebar-footer\">\n          <button class=\"btn btn-outline-light btn-sm w-100\" (click)=\"logout()\">\n            <i class=\"fas fa-sign-out-alt\"></i> Déconnexion\n          </button>\n        </div>\n      </div>\n\n      <!-- Main Content -->\n      <div class=\"main-content\">\n        <!-- Header -->\n        <div class=\"content-header\">\n          <h3>{{getTabTitle()}}</h3>\n          <div class=\"breadcrumb\">\n            <span>Admin</span> <i class=\"fas fa-chevron-right\"></i> <span>{{getTabTitle()}}</span>\n          </div>\n        </div>\n\n        <!-- Dashboard -->\n        <div *ngIf=\"activeTab === 'dashboard' && stats\" class=\"content-body\">\n        <div class=\"row mb-4\">\n          <div class=\"col-md-3\">\n            <div class=\"card bg-primary text-white\">\n              <div class=\"card-body\">\n                <div class=\"d-flex justify-content-between\">\n                  <div>\n                    <h4>{{stats.stats.total_books}}</h4>\n                    <p>Livres Total</p>\n                  </div>\n                  <i class=\"fas fa-book fa-2x\"></i>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-md-3\">\n            <div class=\"card bg-success text-white\">\n              <div class=\"card-body\">\n                <div class=\"d-flex justify-content-between\">\n                  <div>\n                    <h4>{{stats.stats.total_users}}</h4>\n                    <p>Utilisateurs</p>\n                  </div>\n                  <i class=\"fas fa-users fa-2x\"></i>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-md-3\">\n            <div class=\"card bg-info text-white\">\n              <div class=\"card-body\">\n                <div class=\"d-flex justify-content-between\">\n                  <div>\n                    <h4>{{stats.stats.active_borrows}}</h4>\n                    <p>Emprunts Actifs</p>\n                  </div>\n                  <i class=\"fas fa-handshake fa-2x\"></i>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-md-3\">\n            <div class=\"card bg-warning text-white\">\n              <div class=\"card-body\">\n                <div class=\"d-flex justify-content-between\">\n                  <div>\n                    <h4>{{stats.stats.overdue_borrows}}</h4>\n                    <p>En Retard</p>\n                  </div>\n                  <i class=\"fas fa-exclamation-triangle fa-2x\"></i>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"row\">\n          <div class=\"col-md-6\">\n            <div class=\"card\">\n              <div class=\"card-header\">\n                <h5><i class=\"fas fa-star\"></i> Livres Populaires</h5>\n              </div>\n              <div class=\"card-body\">\n                <div *ngFor=\"let book of stats.popular_books\" class=\"mb-2\">\n                  <strong>{{book.title}}</strong> - {{book.author}}\n                  <small class=\"text-muted\">({{book.borrow_count}} emprunts)</small>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-md-6\">\n            <div class=\"card\">\n              <div class=\"card-header\">\n                <h5><i class=\"fas fa-clock\"></i> Emprunts Récents</h5>\n              </div>\n              <div class=\"card-body\">\n                <div *ngFor=\"let borrow of stats.recent_borrows\" class=\"mb-2\">\n                  <strong>{{borrow.book_title}}</strong>\n                  <br><small class=\"text-muted\">{{borrow.user_name}} - {{borrow.date_emprunt | date}}</small>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n        <!-- Livres / Catalogue -->\n        <div *ngIf=\"activeTab === 'books'\" class=\"content-body\">\n          <div class=\"d-flex justify-content-between align-items-center mb-4\">\n            <div class=\"search-filters\">\n              <input type=\"text\" class=\"form-control\" placeholder=\"Recherche titre, auteur, ISBN...\" [(ngModel)]=\"bookSearch\" (input)=\"searchBooks()\">\n              <select class=\"form-select ms-2\" [(ngModel)]=\"bookCategoryFilter\" (change)=\"filterBooks()\">\n                <option value=\"\">Toutes catégories</option>\n                <option *ngFor=\"let cat of categories\" [value]=\"cat.id\">{{cat.name}}</option>\n              </select>\n              <select class=\"form-select ms-2\" [(ngModel)]=\"bookAvailabilityFilter\" (change)=\"filterBooks()\">\n                <option value=\"\">Toutes</option>\n                <option value=\"1\">Disponibles</option>\n                <option value=\"0\">Indisponibles</option>\n              </select>\n            </div>\n            <div>\n              <button class=\"btn btn-outline-secondary me-2\" (click)=\"exportBooks()\">Export CSV</button>\n              <button class=\"btn btn-success\" (click)=\"showAddBookForm = true\">+ Ajouter Livre</button>\n            </div>\n          </div>\n\n          <!-- Table des livres -->\n          <div class=\"table-responsive\">\n            <table class=\"table table-hover\">\n              <thead>\n                <tr>\n                  <th><input type=\"checkbox\" (change)=\"selectAllBooks($event)\"></th>\n                  <th>Couverture</th>\n                  <th>Titre</th>\n                  <th>Auteur(s)</th>\n                  <th>ISBN</th>\n                  <th>Catégorie</th>\n                  <th>Localisation</th>\n                  <th>Stock</th>\n                  <th>Tag UID</th>\n                  <th>Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let book of filteredBooks\">\n                  <td><input type=\"checkbox\" [value]=\"book.id\" (change)=\"toggleBookSelection(book.id, $event)\"></td>\n                  <td><img [src]=\"book.cover_url || 'assets/book-placeholder.jpg'\" width=\"40\" height=\"56\" class=\"book-cover\"></td>\n                  <td>\n                    <strong>{{book.title}}</strong>\n                    <br><small class=\"text-muted\">{{book.times_borrowed || 0}} emprunts</small>\n                  </td>\n                  <td>{{book.author}}</td>\n                  <td>{{book.isbn}}</td>\n                  <td>{{book.category?.name}}</td>\n                  <td>{{book.location || 'Non définie'}}</td>\n                  <td>\n                    <span [class]=\"book.stock > 0 ? 'text-success' : 'text-danger'\">{{book.available || 0}}/{{book.stock}}</span>\n                  </td>\n                  <td>{{book.tag_uid || '—'}}</td>\n                  <td>\n                    <button class=\"btn btn-sm btn-outline-primary me-1\" (click)=\"viewBook(book)\" title=\"Voir\">\n                      <i class=\"fas fa-eye\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-secondary me-1\" (click)=\"editBook(book)\" title=\"Éditer\">\n                      <i class=\"fas fa-edit\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-info me-1\" (click)=\"assignTag(book)\" title=\"Assigner Tag\">\n                      <i class=\"fas fa-tag\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-danger\" (click)=\"deleteBook(book)\" title=\"Supprimer\">\n                      <i class=\"fas fa-trash\"></i>\n                    </button>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        <div class=\"row mb-3\">\n          <div class=\"col-md-8\">\n            <h4>Gestion des Livres</h4>\n          </div>\n          <div class=\"col-md-4\">\n            <button class=\"btn btn-success w-100\" (click)=\"showAddBookForm = true\">\n              <i class=\"fas fa-plus\"></i> Ajouter un Livre\n            </button>\n          </div>\n        </div>\n\n        <!-- Formulaire d'ajout -->\n        <div class=\"card mb-4\" *ngIf=\"showAddBookForm\">\n          <div class=\"card-header\">\n            <h5>Nouveau Livre</h5>\n          </div>\n          <div class=\"card-body\">\n            <form (ngSubmit)=\"addBook()\">\n              <div class=\"row\">\n                <div class=\"col-md-6\">\n                  <div class=\"mb-3\">\n                    <label class=\"form-label\">Titre</label>\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"newBook.title\" name=\"title\" required>\n                  </div>\n                </div>\n                <div class=\"col-md-6\">\n                  <div class=\"mb-3\">\n                    <label class=\"form-label\">Auteur</label>\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"newBook.author\" name=\"author\" required>\n                  </div>\n                </div>\n              </div>\n              <div class=\"row\">\n                <div class=\"col-md-4\">\n                  <div class=\"mb-3\">\n                    <label class=\"form-label\">ISBN</label>\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"newBook.isbn\" name=\"isbn\" required>\n                  </div>\n                </div>\n                <div class=\"col-md-4\">\n                  <div class=\"mb-3\">\n                    <label class=\"form-label\">Catégorie</label>\n                    <select class=\"form-select\" [(ngModel)]=\"newBook.category_id\" name=\"category_id\" required>\n                      <option value=\"\">Sélectionner...</option>\n                      <option *ngFor=\"let category of categories\" [value]=\"category.id\">\n                        {{category.name}}\n                      </option>\n                    </select>\n                  </div>\n                </div>\n                <div class=\"col-md-4\">\n                  <div class=\"mb-3\">\n                    <label class=\"form-label\">Stock</label>\n                    <input type=\"number\" class=\"form-control\" [(ngModel)]=\"newBook.stock\" name=\"stock\" required min=\"1\">\n                  </div>\n                </div>\n              </div>\n              <div class=\"mb-3\">\n                <label class=\"form-label\">Description</label>\n                <textarea class=\"form-control\" [(ngModel)]=\"newBook.description\" name=\"description\" rows=\"3\"></textarea>\n              </div>\n              <div class=\"d-flex gap-2\">\n                <button type=\"submit\" class=\"btn btn-success\">Ajouter</button>\n                <button type=\"button\" class=\"btn btn-secondary\" (click)=\"cancelAddBook()\">Annuler</button>\n              </div>\n            </form>\n          </div>\n        </div>\n\n        <!-- Liste des livres -->\n        <div class=\"row\">\n          <div class=\"col-md-4 mb-3\" *ngFor=\"let book of books\">\n            <div class=\"card\">\n              <div class=\"card-body\">\n                <h6 class=\"card-title\">{{book.title}}</h6>\n                <p class=\"card-text\">\n                  <strong>Auteur:</strong> {{book.author}}<br>\n                  <strong>Catégorie:</strong> {{book.category?.name}}<br>\n                  <strong>Stock:</strong> {{book.available}}/{{book.stock}}\n                </p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n        <!-- Utilisateurs -->\n        <div *ngIf=\"activeTab === 'users'\" class=\"content-body\">\n          <div class=\"d-flex justify-content-between align-items-center mb-4\">\n            <div class=\"search-filters\">\n              <input type=\"text\" class=\"form-control\" placeholder=\"Recherche nom, email...\" [(ngModel)]=\"userSearch\">\n              <select class=\"form-select ms-2\" [(ngModel)]=\"userRoleFilter\">\n                <option value=\"\">Tous rôles</option>\n                <option value=\"user\">Utilisateur</option>\n                <option value=\"admin\">Admin</option>\n              </select>\n              <select class=\"form-select ms-2\" [(ngModel)]=\"userStatusFilter\">\n                <option value=\"\">Tous statuts</option>\n                <option value=\"active\">Actif</option>\n                <option value=\"suspended\">Suspendu</option>\n              </select>\n            </div>\n            <button class=\"btn btn-outline-secondary\">Export CSV</button>\n          </div>\n\n          <div class=\"table-responsive\">\n            <table class=\"table table-hover\">\n              <thead>\n                <tr>\n                  <th>ID</th>\n                  <th>Nom Prénom</th>\n                  <th>Email</th>\n                  <th>Rôle</th>\n                  <th>Tag UID</th>\n                  <th>Emprunts en cours</th>\n                  <th>Statut</th>\n                  <th>Inscription</th>\n                  <th>Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let user of users\">\n                  <td>{{user.id}}</td>\n                  <td>{{user.name}} {{user.surname}}</td>\n                  <td>{{user.email}}</td>\n                  <td><span class=\"badge bg-primary\">{{user.role}}</span></td>\n                  <td>{{user.tag_uid || '—'}}</td>\n                  <td>{{user.active_borrows || 0}}</td>\n                  <td><span class=\"badge\" [class]=\"user.status === 'active' ? 'bg-success' : 'bg-warning'\">{{user.status}}</span></td>\n                  <td>{{user.created_at | date}}</td>\n                  <td>\n                    <button class=\"btn btn-sm btn-outline-primary me-1\" title=\"Voir profil\">\n                      <i class=\"fas fa-eye\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-secondary me-1\" title=\"Éditer\">\n                      <i class=\"fas fa-edit\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-info me-1\" title=\"Assigner tag\">\n                      <i class=\"fas fa-id-card\"></i>\n                    </button>\n                    <button class=\"btn btn-sm\" [class]=\"user.status === 'active' ? 'btn-outline-warning' : 'btn-outline-success'\" title=\"Suspendre/Activer\">\n                      <i class=\"fas\" [class]=\"user.status === 'active' ? 'fa-ban' : 'fa-check'\"></i>\n                    </button>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <!-- Emprunts -->\n        <div *ngIf=\"activeTab === 'borrows'\" class=\"content-body\">\n          <div class=\"row mb-4\">\n            <div class=\"col-md-3\">\n              <button class=\"btn\" [class]=\"borrowView === 'current' ? 'btn-primary' : 'btn-outline-primary'\" (click)=\"borrowView = 'current'\">En cours</button>\n            </div>\n            <div class=\"col-md-3\">\n              <button class=\"btn\" [class]=\"borrowView === 'history' ? 'btn-primary' : 'btn-outline-primary'\" (click)=\"borrowView = 'history'\">Historique</button>\n            </div>\n            <div class=\"col-md-6\">\n              <input type=\"text\" class=\"form-control\" placeholder=\"Recherche par livre ou utilisateur...\">\n            </div>\n          </div>\n          <div class=\"table-responsive\">\n            <table class=\"table table-hover\">\n              <thead>\n                <tr>\n                  <th>ID</th>\n                  <th>Livre</th>\n                  <th>Utilisateur</th>\n                  <th>Date emprunt</th>\n                  <th>Date retour prévue</th>\n                  <th>Device</th>\n                  <th>Jours de retard</th>\n                  <th>Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let borrow of borrows\">\n                  <td>{{borrow.id}}</td>\n                  <td>{{borrow.title}}</td>\n                  <td>{{borrow.user_name}}</td>\n                  <td>{{borrow.date_emprunt | date}}</td>\n                  <td>{{borrow.date_retour_prevue | date}}</td>\n                  <td>{{borrow.device || '—'}}</td>\n                  <td>\n                    <span *ngIf=\"borrow.days_overdue > 0\" class=\"text-danger\">{{borrow.days_overdue}}</span>\n                    <span *ngIf=\"borrow.days_overdue <= 0\" class=\"text-success\">—</span>\n                  </td>\n                  <td>\n                    <button class=\"btn btn-sm btn-outline-success me-1\" (click)=\"returnBook(borrow.id)\" title=\"Marquer retourné\">\n                      <i class=\"fas fa-check\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-primary me-1\" title=\"Prolonger\">\n                      <i class=\"fas fa-calendar-plus\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-warning\" title=\"Envoyer rappel\">\n                      <i class=\"fas fa-envelope\"></i>\n                    </button>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <!-- Inventaire IoT -->\n        <div *ngIf=\"activeTab === 'inventory'\" class=\"content-body\">\n          <div class=\"row mb-4\">\n            <div class=\"col-md-6\">\n              <div class=\"card\">\n                <div class=\"card-header\">\n                  <h5><i class=\"fas fa-wifi\"></i> Devices IoT</h5>\n                </div>\n                <div class=\"card-body\">\n                  <div class=\"device-item\" *ngFor=\"let device of iotDevices\">\n                    <div class=\"d-flex justify-content-between align-items-center\">\n                      <div>\n                        <strong>{{device.name}}</strong>\n                        <br><small class=\"text-muted\">{{device.type}}</small>\n                      </div>\n                      <span class=\"badge\" [class]=\"device.status === 'online' ? 'bg-success' : 'bg-danger'\">\n                        {{device.status}}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div class=\"col-md-6\">\n              <div class=\"card\">\n                <div class=\"card-header\">\n                  <h5><i class=\"fas fa-search\"></i> Inventaire temps réel</h5>\n                </div>\n                <div class=\"card-body\">\n                  <button class=\"btn btn-primary mb-3\" (click)=\"startInventoryScan()\">Lancer scan manuel</button>\n                  <div *ngFor=\"let shelf of shelves\">\n                    <strong>{{shelf.name}}</strong>: {{shelf.detected_books}} livres détectés\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <!-- Retards & Pénalités -->\n        <div *ngIf=\"activeTab === 'overdue'\" class=\"content-body\">\n          <div class=\"table-responsive\">\n            <table class=\"table table-hover\">\n              <thead>\n                <tr>\n                  <th>Utilisateur</th>\n                  <th>Livre</th>\n                  <th>Date prévue</th>\n                  <th>Jours de retard</th>\n                  <th>Montant pénalité</th>\n                  <th>Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let overdue of overdueBorrows\">\n                  <td>{{overdue.user_name}}</td>\n                  <td>{{overdue.book_title}}</td>\n                  <td>{{overdue.due_date | date}}</td>\n                  <td class=\"text-danger\">{{overdue.days_overdue}}</td>\n                  <td>{{overdue.penalty_amount | currency:'EUR'}}</td>\n                  <td>\n                    <button class=\"btn btn-sm btn-outline-warning me-1\" title=\"Appliquer pénalité\">\n                      <i class=\"fas fa-euro-sign\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-primary me-1\" title=\"Envoyer relance\">\n                      <i class=\"fas fa-envelope\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-danger\" title=\"Liste noire\">\n                      <i class=\"fas fa-ban\"></i>\n                    </button>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <!-- Demandes / Inscriptions -->\n        <div *ngIf=\"activeTab === 'requests'\" class=\"content-body\">\n          <div class=\"table-responsive\">\n            <table class=\"table table-hover\">\n              <thead>\n                <tr>\n                  <th>Nom</th>\n                  <th>Email</th>\n                  <th>Date demande</th>\n                  <th>Documents</th>\n                  <th>Statut</th>\n                  <th>Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let request of registrationRequests\">\n                  <td>{{request.name}} {{request.surname}}</td>\n                  <td>{{request.email}}</td>\n                  <td>{{request.created_at | date}}</td>\n                  <td>\n                    <span class=\"badge bg-info\" *ngIf=\"request.documents_uploaded\">Uploadés</span>\n                    <span class=\"badge bg-warning\" *ngIf=\"!request.documents_uploaded\">Manquants</span>\n                  </td>\n                  <td>\n                    <span class=\"badge bg-warning\">En attente</span>\n                  </td>\n                  <td>\n                    <button class=\"btn btn-sm btn-outline-success me-1\" title=\"Valider\">\n                      <i class=\"fas fa-check\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-danger me-1\" title=\"Refuser\">\n                      <i class=\"fas fa-times\"></i>\n                    </button>\n                    <button class=\"btn btn-sm btn-outline-info\" title=\"Demander justificatif\">\n                      <i class=\"fas fa-file-alt\"></i>\n                    </button>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n\n        <!-- Statistiques & Rapports -->\n        <div *ngIf=\"activeTab === 'reports'\" class=\"content-body\">\n          <div class=\"row\">\n            <div class=\"col-md-4\">\n              <div class=\"card\">\n                <div class=\"card-header\">\n                  <h5>Rapports disponibles</h5>\n                </div>\n                <div class=\"card-body\">\n                  <button class=\"btn btn-outline-primary w-100 mb-2\" (click)=\"exportReport('top-books')\">Top livres</button>\n                  <button class=\"btn btn-outline-primary w-100 mb-2\" (click)=\"exportReport('monthly-activity')\">Activité mensuelle</button>\n                  <button class=\"btn btn-outline-primary w-100 mb-2\" (click)=\"exportReport('active-users')\">Utilisateurs actifs</button>\n                  <button class=\"btn btn-outline-primary w-100\" (click)=\"exportReport('iot-stats')\">Statistiques IoT</button>\n                </div>\n              </div>\n            </div>\n            <div class=\"col-md-8\">\n              <div class=\"card\">\n                <div class=\"card-header\">\n                  <h5>Graphiques</h5>\n                </div>\n                <div class=\"card-body\">\n                  <!-- Placeholder pour graphiques -->\n                  <p class=\"text-muted\">Graphiques d'activité à implémenter</p>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <!-- Configuration -->\n        <div *ngIf=\"activeTab === 'settings'\" class=\"content-body\">\n          <div class=\"row\">\n            <div class=\"col-md-6\">\n              <div class=\"card\">\n                <div class=\"card-header\">\n                  <h5>Paramètres système</h5>\n                </div>\n                <div class=\"card-body\">\n                  <div class=\"mb-3\">\n                    <label class=\"form-label\">Durée d'emprunt par défaut (jours)</label>\n                    <input type=\"number\" class=\"form-control\" [(ngModel)]=\"settings.default_borrow_days\" value=\"14\">\n                  </div>\n                  <div class=\"mb-3\">\n                    <label class=\"form-label\">Pénalité par jour (€)</label>\n                    <input type=\"number\" class=\"form-control\" [(ngModel)]=\"settings.penalty_per_day\" value=\"0.5\" step=\"0.1\">\n                  </div>\n                  <button class=\"btn btn-success\">Sauvegarder</button>\n                </div>\n              </div>\n            </div>\n            <div class=\"col-md-6\">\n              <div class=\"card\">\n                <div class=\"card-header\">\n                  <h5>Paramètres IoT</h5>\n                </div>\n                <div class=\"card-body\">\n                  <div class=\"mb-3\">\n                    <label class=\"form-label\">MQTT Broker</label>\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"settings.mqtt_broker\" placeholder=\"localhost:1883\">\n                  </div>\n                  <div class=\"mb-3\">\n                    <label class=\"form-label\">Topic RFID</label>\n                    <input type=\"text\" class=\"form-control\" [(ngModel)]=\"settings.rfid_topic\" placeholder=\"library/rfid\">\n                  </div>\n                  <button class=\"btn btn-success\">Sauvegarder</button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <!-- Logs / Audit -->\n        <div *ngIf=\"activeTab === 'logs'\" class=\"content-body\">\n          <div class=\"d-flex justify-content-between align-items-center mb-4\">\n            <div class=\"search-filters\">\n              <input type=\"text\" class=\"form-control\" placeholder=\"Recherche dans les logs...\">\n              <select class=\"form-select ms-2\">\n                <option value=\"\">Tous types</option>\n                <option value=\"admin\">Actions admin</option>\n                <option value=\"device\">Événements device</option>\n                <option value=\"error\">Erreurs système</option>\n              </select>\n            </div>\n            <button class=\"btn btn-outline-secondary\">Export logs</button>\n          </div>\n\n          <div class=\"table-responsive\">\n            <table class=\"table table-hover\">\n              <thead>\n                <tr>\n                  <th>Date/Heure</th>\n                  <th>Type</th>\n                  <th>Utilisateur</th>\n                  <th>Action</th>\n                  <th>Détails</th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr *ngFor=\"let log of auditLogs\">\n                  <td>{{log.created_at | date:'short'}}</td>\n                  <td><span class=\"badge\" [class]=\"getLogTypeClass(log.type)\">{{log.type}}</span></td>\n                  <td>{{log.user_name || 'Système'}}</td>\n                  <td>{{log.action}}</td>\n                  <td>{{log.details}}</td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n      </div>\n    </div>\n  `,\n  styles: [`\n    .admin-layout {\n      display: flex;\n      min-height: 100vh;\n    }\n    .sidebar {\n      width: 280px;\n      background: linear-gradient(180deg, #f8f9fa 0%, #e9ecef 100%);\n      border-right: 1px solid #dee2e6;\n      display: flex;\n      flex-direction: column;\n    }\n    .sidebar-header {\n      padding: 1.5rem;\n      border-bottom: 1px solid #dee2e6;\n      background: white;\n    }\n    .sidebar-header h4 {\n      margin: 0;\n      color: #495057;\n    }\n    .sidebar-nav {\n      flex: 1;\n      padding: 1rem 0;\n    }\n    .nav-item {\n      display: block;\n      padding: 0.75rem 1.5rem;\n      color: #6c757d;\n      text-decoration: none;\n      transition: all 0.2s;\n      cursor: pointer;\n    }\n    .nav-item:hover {\n      background: rgba(0,123,255,0.1);\n      color: #007bff;\n    }\n    .nav-item.active {\n      background: #007bff;\n      color: white;\n      border-right: 3px solid #0056b3;\n    }\n    .nav-item i {\n      width: 20px;\n      margin-right: 10px;\n    }\n    .sidebar-footer {\n      padding: 1rem;\n      border-top: 1px solid #dee2e6;\n    }\n    .main-content {\n      flex: 1;\n      display: flex;\n      flex-direction: column;\n    }\n    .content-header {\n      background: white;\n      padding: 1.5rem 2rem;\n      border-bottom: 1px solid #dee2e6;\n    }\n    .content-header h3 {\n      margin: 0;\n      color: #495057;\n    }\n    .breadcrumb {\n      color: #6c757d;\n      font-size: 0.875rem;\n      margin-top: 0.5rem;\n    }\n    .breadcrumb i {\n      margin: 0 0.5rem;\n      font-size: 0.75rem;\n    }\n    .content-body {\n      flex: 1;\n      padding: 2rem;\n      background: #f8f9fa;\n    }\n    .search-filters {\n      display: flex;\n      gap: 0.5rem;\n    }\n    .search-filters .form-control,\n    .search-filters .form-select {\n      min-width: 200px;\n    }\n    .book-cover {\n      border-radius: 4px;\n      object-fit: cover;\n    }\n    .device-item {\n      padding: 0.75rem;\n      border-bottom: 1px solid #dee2e6;\n    }\n    .device-item:last-child {\n      border-bottom: none;\n    }\n    @media (max-width: 768px) {\n      .admin-layout {\n        flex-direction: column;\n      }\n      .sidebar {\n        width: 100%;\n        height: auto;\n      }\n      .sidebar-nav {\n        display: flex;\n        overflow-x: auto;\n        padding: 0.5rem;\n      }\n      .nav-item {\n        white-space: nowrap;\n        min-width: 150px;\n      }\n    }\n  `]\n})], AdminDashboardComponent);\nexport { AdminDashboardComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}